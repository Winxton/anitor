{% load staticfiles %}
{% load nyaacrawler_extras %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Anitor Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Loading Bootstrap -->
    <link href="{% static 'nyaacrawler/bootstrap/css/bootstrap.css' %}" rel="stylesheet">

    <!-- Loading Flat UI -->
    <link href="{% static 'nyaacrawler/css/flat-ui.css' %}" rel="stylesheet">
    <link rel="shortcut icon" href="images/favicon.ico">
    
    <!--Loading jquery library -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> 
    
    <!-- Loading Scrollbar -->
    <link href="{% static 'nyaacrawler/custom-scrollbar-plugin/jquery.mCustomScrollbar.css' %}" rel="stylesheet" type="text/css" />
    <script src="{% static 'nyaacrawler/custom-scrollbar-plugin/jquery.mCustomScrollbar.concat.min.js' %}"></script>
    
    <!-- Loading custom CSS -->
    <link href="{% static 'nyaacrawler/css/test1.css' %}" rel="stylesheet">
    
    <!--Loading fancyBox -->
    <script type="text/javascript" src="{% static 'nyaacrawler/fancyBox/source/jquery.fancybox.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'nyaacrawler/fancyBox/source/jquery.fancybox.css' %}" media="screen" />
    
    <!--Loading checkbox and radio Javascript -->
    <script src="{% static 'nyaacrawler/js/flatui-checkbox.js' %}"></script>
    <script src="{% static 'nyaacrawler/js/flatui-radio.js' %}"></script>
    
    <!--Loading custom Javascript -->
    <script type="text/javascript" src="{% static 'nyaacrawler/js/test.js' %}"></script>
  </head>
  <body>

    {% for anime in animeList %}
    {% if anime.current_episode > 0 %}
    <div class="sub-wrapper" id="theworldonlygodknows">
        <div class="element-border">
            <div class="image">
                <img src="{{ anime.image }}"/>
            </div>
            <div class="data-container">
                <div class="anime-title">
                    <h3>{{ anime.official_title }}</h3>
                </div>
                <div class="ep-navigation nav-bar">
                <ul>
                    <li class="previous"><a href="#fakelink" class="fui-arrow-left nav-arrow"></a></li>
                    <li class="ep-number">Episode {{ anime.current_episode }}</li>
                    <li class="next"><a href="#fakelink" class="fui-arrow-right nav-arrow"></a></li>
                </ul>
                </div>
                <div class="table-header">
                    <table>
                        <tr align=left>
                            <th class="fansub-head">Fansub Group</th>
                            <th class="quality-head">Quality</th>
                            <th class="size-head">Size</th>
                            <th class="seed-head">Seed</th>
                            <th class="leach-head">Leech</th>
                        </tr>
                    </table>
                </div>
                <div class="table-data">
                    <table class="anime-data">
                        {% for torrent in anime.latest_episodes %}
                        <tr> 
                            <td class="fansub">{{ torrent.fansub }}</td>
                            <td class="quality">{{ torrent.quality }}</td>
                            <td class="file-size">{{ torrent.file_size }}</td>
                            <td class="seed">{{ torrent.seeders }}</td>
                            <td class="leach">{{ torrent.leechers }}</td>                        
                            <td class="magnet"><a href="{{ torrent|magnet_link }}" class="btn btn-block btn-primary magtor">Magnet</a></td>
                            <td class="torrent"><a href="{{ torrent.url }}" class="btn btn-block btn-primary magtor">Torrent</a></td>
                        </tr>
                        {% endfor %}
                    </table>
                </div>
            </div>
        </div>
        <a href="#inline1" class="btn btn-block btn-primary subscribe fancybox">Subscribe</a>
    </div>  
    {% endif %}
    {% endfor %}

    <div id="inline1">
        <h3>Subscribe</h3>
        <div id="fansub-wrapper">
            <h4>Fansub</h4>
            <form>
                <label class="checkbox checkbox-all-fansub checked">
                    <input class="checkbox-option-all-fansub" type="checkbox" checked="checked" data-toggle="checkbox">
                    All
                </label>
                <div id="fansub-list">
                </div>
            </form>
        </div>
        <div id="quality-wrapper">
            <h4>Quality</h4>
            <form>
                <label class="checkbox checkbox-all-quality checked">
                    <input class="checkbox-option-all-quality" type="checkbox" checked="checked" data-toggle="checkbox">
                    Any
                </label>
                <div id="quality-list">
                </div>
            </form>
        </div>
        <br>
        <div id="email-wrapper">
            <form>
                <h4><b>Email</b> : <input type="text" name="email" id="email-box"/>
                <input type="submit" value="Subscribe" class="btn btn-block subscribe-final"/></h4>
            </form>
        </div>
        <div id="subscribe-wrapper">
            
        </div>
        <div class="alert alert-error" id="alert-error-private">
            <button type="button" class="close"></button>
            <strong>Error! </strong>Please put in your correct email address
        </div>
    </div> 
    </div>

  </body>
</html>
<!--

<!DOCTYPE html>
<html lang="en">
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
</head>

<body>
<h3>Anime Listings</h3>
Search: <input type="text" id="anime_search"/><br><br>

<div id = "anime_listings">
{% for anime in animeList %}
        <b>{{ anime.official_title }}</b> <br>
        Current Episode: {{ anime.current_episode.max_episode }}<br/>
        {% for torrent in anime.latest_episodes %}
            {{ torrent.fansub }}
            {{ torrent.episode }}
            {{ torrent.quality }}
            <br>
        {% endfor %}
        <br>
{% endfor %}
</div>

<script>

function boldSelected(str, s, e) {
    return str.substring(0, s) + "<b>" + str.substring(s,e) + "</b>" + str.substring(e);
}

//var searchURL = "/get-anime-list/";
$('#anime_search').keyup(function() {
    searchTerm = this.value.toLowerCase();
    
    $.get(
        "{% url 'animeList' %}", 
        {search:searchTerm},
        function(response) {
            $("#anime_listings").empty();
            $.each
            (
                response,
                function(ani_key, ani_value) {
                    var startIdx = ani_value['title'].toLowerCase().indexOf(searchTerm);
                    var endIdx = startIdx + searchTerm.length;
                    var html = ani_key +" "+ boldSelected(ani_value['title'], startIdx, endIdx);
                    
                    var torrents = ani_value['torrents'];

                    $.each(
                        torrents,
                        function(tor_key, tor_val) {
                            html += "<br>";
                            html += (tor_val['fansub']);
                            html += (tor_val['quality']);
                        }
                    );
                    
                    html += '<br><br>'
                    
                    $("#anime_listings").append(html);
                }
            );
        },
        "json"
    );

});
</script>
</body>
</html>

-->